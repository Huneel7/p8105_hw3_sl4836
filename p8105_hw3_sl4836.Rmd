---
title: "p8105_hw3_sl4836"
author: "Hun"
date: "10/16/2021"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
```

```{r}
getwd()

dir.create(file.path(getwd(), "hw3_data_file"), recursive = TRUE)

list.files()
```

```{r}
library(p8105.datasets)
data("instacart")
```

```{r}
instacart <- instacart

instacart %>% dim()
instacart %>% names() 
instacart %>% head()

Arranged_aisles <- instacart %>% 
  group_by(aisle) %>% 
  summarise(n = n()) %>% arrange(desc(n))

Arranged_aisles %>% 
  filter(n>10000) %>%
  ggplot(aes(x = reorder(aisle, n), y =n)) + 
  geom_point() + 
  coord_flip()


```
1. There are 134 aisles. Fresh vegetables aisles are the most items ordered from.

2.

```{r}
options(knitr.kable.NA = 0)

baking_top3 <- instacart %>% 
  filter(aisle == "baking ingredients") %>% 
  group_by(product_name) %>% 
  summarise(n = n()) %>% 
  arrange(desc(n)) %>% 
  slice(1:3) %>%
  mutate(aisle = "baking ingredients")

dog_food_top3 <- instacart %>% 
  filter(aisle == "dog food care") %>% 
  group_by(product_name) %>% 
  summarise(n = n()) %>% 
  arrange(desc(n)) %>% 
  slice(1:3) %>%
  mutate(aisle = "dog food care")

packaged_vege_fruit_top3 <- instacart %>% 
  filter(aisle == "packaged vegetables fruits") %>% 
  group_by(product_name) %>% 
  summarise(n = n()) %>% 
  arrange(desc(n)) %>% 
  slice(1:3) %>%
  mutate(aisle = "packaged vegetables fruits")

bind_rows(baking_top3 ,dog_food_top3, packaged_vege_fruit_top3) %>%
  pivot_wider(names_from = product_name, values_from = n)  %>%
  knitr::kable(align = "c", format = "pipe")
```

```{r}
instacart %>% 
  filter(product_name == "Pink Lady Apples" |product_name == "Coffee Ice Cream") %>%
  group_by(product_name, order_dow) %>% 
  summarise(mean_hour = mean(order_hour_of_day)) %>%
  pivot_wider(names_from = order_dow, values_from = mean_hour) %>%
  knitr::kable(align = "c", format = "pipe")
  

```

```{r}

```

```{r}

```



```{r}

```

```{r}

```

